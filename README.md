# Reserve

Задача:

Да се резервират билети в кино със зала с 10 места. Да се използва Command Pattern. Да се използват колекции. 
Да се ползва файл за съхранение. Да се изработи протокол за комуникация.
Да има паралелно резервиране и да се реализира защита от конкорентно резервиране.

Поддържани команди:
  Показване на заетост на залата -view
  
  Резервация на едно или повече места -update
  
  !Отмяна на резервация - cancel
  
  !Визуализация на програмата на предстоящи прожекции по зали и часове -viewProgram
  
  !Добавяне на пожекция - addFilm
    
!Все още не са реализирани
 
Протокол за комуникация- базиран на java Сериализация.

За всяка от горните дейности се изпраща заявка, съдържаща конкретни параметри, а сървъра изпраща отговор.

Протоколът се състои от две основни съобщения:
	1.за управление на програмата - Информацията за програмата съдържа списък с: 
	   зала, дата и час на прожекцията и име на филм
	2.за управление на конкретна зала и прожекция - Информацията за прожекцията се дава като : 
	    име на филм, зала, дата и час на прожекцията и заетост на седалки

Предлагат се два варианта за защита на "базата" - Файла от колизии:
1. Единичен тред, който чете и записва във файла, а всички останали тредове коминикират с него през опашка.
2. Всички тредове пишат върху един файл, но всяка промяна се добавя към края на файла.

При това положение е възможно два треда да резервират едно и също място. За да се избегне, това по време на четене се изчитат всички записи от началото на файла. От началото всички места са свободни, а с всеки прочетен запис заетите места се наслагват. Ако резервацията от различните записи е върху различни места, конфликт няма не зависимо как са били записани. Ако с поредният запис се прави опит за резервиране на вече резервирано място, то това е колизия. Те се игнорират от механизма за четене. 

Защитата сработва така:
Всеки тред прави запис и веднага изчита резултата. Ако резервацията е била успешна след прочитане ще се установи, че местата са заети от клиента, който този тред обслужва. Ако е имало колизия местата ще са маркирани като заети от друг клиент. В този режим най-бавна е операцията за четене, но в едно зала се очаква да има максимум 50-100 места, а по задание 10. Също така алгоритъмът подлежи на оптимизация като от време на време се записва актуално състояние като единствен запис.
